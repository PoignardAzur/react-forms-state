{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 02a10cc9a81ae6681caa","webpack:///external {\"root\":\"immutable\",\"commonjs2\":\"immutable\",\"commonjs\":\"immutable\",\"amd\":\"immutable\"}","webpack:///./lib/StateValueHelpers.js","webpack:///./lib/ValidationHelpers.js","webpack:///./lib/FormEvents.js","webpack:///external {\"root\":\"React\",\"commonjs2\":\"react\",\"commonjs\":\"react\",\"amd\":\"react\"}","webpack:///external {\"root\":\"Rx\",\"commonjs2\":\"rxjs\",\"commonjs\":\"rxjs\",\"amd\":\"rxjs\"}","webpack:///./lib/StateProxy.js","webpack:///(webpack)/buildin/global.js","webpack:///./lib/StatePathHelpers.js","webpack:///./lib/FormController.js","webpack:///./lib/FormModel.js","webpack:///./lib/StateDispatcher.js","webpack:///./lib/StateInjector.js","webpack:///./lib/ValidationComposition.js","webpack:///./lib/index.js"],"names":["getJavascriptEntity","getImmutableEntity","getValue","setValue","obj","toJS","state","path","valuePath","reduce","red","value","i","undefined","immutState","global","process","env","FORMALIZR_ENV","console","log","newState","setIn","isValid","getErrorText","validation","infos","Object","keys","length","setErrorForFieldAt","statePath","error","removeErrorForFieldAt","Validation","getErrorForFieldAt","createValueChangeEvent","createInitialChangeEvent","createSubmitChangeEvent","createValidationFailedEvent","VALUE_CHANGE_EVENT_TYPE","INITIAL_CHANGE_EVENT_TYPE","SUBMIT_EVENT_TYPE","VALIDATION_FAILED_EVENT_TYPE","newValue","type","newInitial","StateProxy","NeverObservable","Observable","never","root","validate","uncontrolledConfig","WrappedComponent","ProxiedState","props","context","configureObs","currentStatePath","getCurrentStatePath","name","valueChangeObs","parentValueChangeObs","getAssignedObs","__debug","warn","getHumanReadableIdentifier","do","getCompleteCurrentStatePath","e","filter","startsWith","map","assign","getNestedValidation","isControlled","disconnectFromFormController","subscription","subscribe","setState","unsubscribe","addHandler","getUncontrolledState","child","dispatchUncontrolledValues","connectToUncontrolledHandlers","connectToFormController","nextProps","nextContext","v","Array","isArray","index","findIndex","id","completeStatePath","getNewPathPart","getNewCompletePathPart","uncontrolled","getStatePathToDispatch","rootValueChangeObs","onChange","sp","onStateChange","elem","Component","defaultProps","contextTypes","PropTypes","string","any","func","bool","childContextTypes","getImmutPath","getNewPath","split","isNaN","p","parseInt","FormController","applyControl","convertIn","convertOut","checkIfModified","immutableInitial","Controller","subject","Subject","scan","acc","newValidation","controlledNewState","oldValue","_getInitialValue","share","next","_submit","publishBehavior","refCount","rootDispatcherGetter","oldInitial","initial","mergeDeep","_mergeValues","onSubmit","onValidationFailed","attachToController","getter","convertConversionModelToConversionJobs","validateModel","model","currentInPath","parentOutPath","currentNodeOutPath","out","out_path","currentOutPath","jobs","concat","of","in","default","includes","nodeKey","childNode","childInPath","immutableValue","groupCollapsed","convertedValue","reduceRight","job","inPath","outPath","notConvertedValue","getIn","inValue","newRed","groupEnd","outValue","validateState","wholeValidation","fieldValue","Error","StateDispatcher","Dispatcher","handlers","event","forEach","set","convertedInParentValue","completeValue","update","list","item","getHandler","setHandler","get","bind","propTypes","StateInjector","watchPath","getWatchedPath","selectObs","connectsToFormController","children","watchedValidation","watchedStatePath","notNull","notUndefined","notEmpty","composeValidation","required","isTrue","maxLength","lessThan","errorString","validateNotNull","validateNotUndefined","validateNotEmpty","validates","validateValue","validated","validateTrue","max","validateMaxLength","accessor1","accessor2","validateLessThan","value1","value2"],"mappings":"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","file":"bundle.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"immutable\"), require(\"react\"), require(\"rxjs\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"immutable\", \"react\", \"rxjs\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"ReactFormsState\"] = factory(require(\"immutable\"), require(\"react\"), require(\"rxjs\"));\n\telse\n\t\troot[\"ReactFormsState\"] = factory(root[\"immutable\"], root[\"React\"], root[\"Rx\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_0__, __WEBPACK_EXTERNAL_MODULE_4__, __WEBPACK_EXTERNAL_MODULE_5__) {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 14);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 02a10cc9a81ae6681caa","module.exports = __WEBPACK_EXTERNAL_MODULE_0__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external {\"root\":\"immutable\",\"commonjs2\":\"immutable\",\"commonjs\":\"immutable\",\"amd\":\"immutable\"}\n// module id = 0\n// module chunks = 0","\"use babel\";\r\n// @flow\r\n\r\nimport { fromJS } from \"immutable\";\r\nimport { getImmutPath } from \"./StatePathHelpers\";\r\n\r\nexport function getJavascriptEntity(obj: any): any {\r\n  if (obj && typeof obj == \"object\" && obj.toJS) return obj.toJS();\r\n  else return obj;\r\n}\r\n\r\nexport function getImmutableEntity(obj: any): any {\r\n  if (obj && typeof obj == \"object\" && obj.toJS) return obj;\r\n  else if (typeof obj == \"object\") return fromJS(obj);\r\n  else return obj;\r\n}\r\n\r\nexport function getValue(state: Object, path: string): any {\r\n  if (path == \"\")\r\n    return getJavascriptEntity(state);\r\n  else {\r\n    if (typeof state == \"object\") {\r\n      let valuePath = getImmutPath(path);\r\n      return valuePath.reduce(\r\n        (red, value, i) => {\r\n          if (red !== undefined && red !== null) {\r\n            return red[value];\r\n          } else {\r\n            return red;\r\n          }\r\n        },\r\n        state,\r\n      );\r\n    } else\r\n      return state;\r\n  }\r\n}\r\n\r\nexport function setValue(state?: Object, path: string, value: any): Object {\r\n  if (path == \"\")\r\n    return value;\r\n  else {\r\n    let immutState = fromJS(state);\r\n    if (\r\n      global.process &&\r\n      global.process.env &&\r\n      global.process.env.FORMALIZR_ENV === \"DEBUG\"\r\n    )\r\n      console.log(state, path, value, immutState);\r\n    const newState = immutState\r\n      ? immutState.setIn(getImmutPath(path), value).toJS()\r\n      : immutState;\r\n    return newState;\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./lib/StateValueHelpers.js","\"use babel\";\r\n// @flow\r\n\r\nimport { fromJS } from \"immutable\";\r\nimport { getJavascriptEntity } from \"./StateValueHelpers\";\r\nimport { getImmutPath } from \"./StatePathHelpers\";\r\n\r\nexport type ValidationError =\r\n  | { [key: string | number]: ValidationError }\r\n  | string;\r\nexport type ValidationInfo =\r\n  | { [key: string | number]: ValidationInfo }\r\n  | ValidationError\r\n  | boolean;\r\n\r\nexport function isValid(validation: Validation): boolean {\r\n  if (typeof validation === \"boolean\") return validation;\r\n  else if (validation == null) return true;\r\n  else if (\r\n    typeof validation === \"object\" &&\r\n    typeof validation.infos === \"object\" &&\r\n    validation.infos !== null &&\r\n    Object.keys(validation.infos).length === 0\r\n  )\r\n    return true;\r\n  else {\r\n    return validation.infos === true || validation.infos == null;\r\n  }\r\n}\r\n\r\nexport function getErrorText(validation: Validation): ?string {\r\n  if (typeof validation.infos === \"string\") return validation.infos;\r\n  else return null;\r\n}\r\n\r\nfunction setErrorForFieldAt(\r\n  infos: ValidationInfo,\r\n  statePath: string,\r\n  error: ?string,\r\n): ValidationInfo {\r\n  if (statePath == \"\" || infos == null || typeof infos != \"object\") {\r\n    return infos;\r\n  } else {\r\n    return fromJS(infos).setIn(getImmutPath(statePath), error).toJS();\r\n  }\r\n}\r\n\r\nfunction removeErrorForFieldAt(\r\n  infos: ValidationInfo,\r\n  statePath: string,\r\n): ValidationInfo {\r\n  return setErrorForFieldAt(infos, statePath, null);\r\n}\r\n\r\nexport class Validation {\r\n  infos: ValidationInfo;\r\n\r\n  constructor(infos: ValidationInfo = {}) {\r\n    this.infos = infos;\r\n  }\r\n\r\n  setErrorForFieldAt(statePath: string, error: string): Validation {\r\n    return new Validation(setErrorForFieldAt(this.infos, statePath, error));\r\n  }\r\n\r\n  removeErrorForFieldAt(statePath: string): Validation {\r\n    return new Validation(removeErrorForFieldAt(this.infos, statePath));\r\n  }\r\n\r\n  getErrorForFieldAt(statePath: string): ?ValidationError {\r\n    if (statePath === \"\") return getJavascriptEntity(this.infos);\r\n    else {\r\n      if (typeof this.infos === \"object\") {\r\n        let valuePath = getImmutPath(statePath);\r\n        return valuePath.reduce((red, value, i) => {\r\n          if (red !== undefined && red !== null && typeof red == \"object\") {\r\n            return red[value];\r\n          } else {\r\n            return red;\r\n          }\r\n        }, this.infos);\r\n      } else return null;\r\n    }\r\n  }\r\n\r\n  getNestedValidation(statePath: string): Validation {\r\n    if (statePath === \"\") {\r\n      return this;\r\n    } else {\r\n      return new Validation(this.getErrorForFieldAt(statePath));\r\n    }\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./lib/ValidationHelpers.js","\"use babel\";\r\n// @flow\r\n\r\nimport { Validation } from \"./ValidationHelpers\";\r\n\r\nexport const VALUE_CHANGE_EVENT_TYPE = \"VALUE_CHANGE\";\r\nexport const INITIAL_CHANGE_EVENT_TYPE = \"INITIAL_CHANGE\";\r\nexport const SUBMIT_EVENT_TYPE = \"SUBMIT\";\r\nexport const VALIDATION_FAILED_EVENT_TYPE = \"VALIDATION_FAILED\";\r\n\r\nexport type ValueChangeEventType = {\r\n  type: typeof VALUE_CHANGE_EVENT_TYPE,\r\n  newValue: any,\r\n  statePath: string,\r\n  validation: Validation,\r\n};\r\n\r\nexport function createValueChangeEvent(\r\n  newValue: any,\r\n  statePath: string,\r\n  validation: Validation,\r\n): ValueChangeEventType {\r\n  return {\r\n    type: VALUE_CHANGE_EVENT_TYPE,\r\n    newValue,\r\n    statePath,\r\n    validation,\r\n  };\r\n}\r\n\r\nexport type InitialChangeEventType = {\r\n  type: typeof INITIAL_CHANGE_EVENT_TYPE,\r\n  newValue: any,\r\n  validation: Validation,\r\n};\r\n\r\nexport function createInitialChangeEvent(newInitial: any): InitialChangeEventType {\r\n  return {\r\n    type: INITIAL_CHANGE_EVENT_TYPE,\r\n    newValue: newInitial,\r\n  };\r\n}\r\n\r\nexport type SubmitChangeEventType = {\r\n  type: typeof SUBMIT_EVENT_TYPE,\r\n};\r\n\r\nexport function createSubmitChangeEvent(): SubmitChangeEventType {\r\n  return {\r\n    type: SUBMIT_EVENT_TYPE,\r\n  };\r\n}\r\n\r\nexport type ValidationFailedEventType = {\r\n  type: typeof VALIDATION_FAILED_EVENT_TYPE,\r\n  validation: Validation,\r\n};\r\n\r\nexport function createValidationFailedEvent(validation: Validation): ValidationFailedEventType {\r\n  return {\r\n    type: VALIDATION_FAILED_EVENT_TYPE,\r\n    validation: validation,\r\n  };\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./lib/FormEvents.js","module.exports = __WEBPACK_EXTERNAL_MODULE_4__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external {\"root\":\"React\",\"commonjs2\":\"react\",\"commonjs\":\"react\",\"amd\":\"react\"}\n// module id = 4\n// module chunks = 0","module.exports = __WEBPACK_EXTERNAL_MODULE_5__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external {\"root\":\"Rx\",\"commonjs2\":\"rxjs\",\"commonjs\":\"rxjs\",\"amd\":\"rxjs\"}\n// module id = 5\n// module chunks = 0","\"use babel\";\r\n// @flow\r\n\r\nimport React from \"react\";\r\nimport { getValue, setValue } from \"./StateValueHelpers\";\r\nimport {\r\n  INITIAL_CHANGE_EVENT_TYPE,\r\n  VALUE_CHANGE_EVENT_TYPE,\r\n  VALIDATION_FAILED_EVENT_TYPE,\r\n} from \"./FormEvents\";\r\nimport Rx from \"rxjs\";\r\nimport { Validation } from \"./ValidationHelpers\";\r\n\r\nconst NeverObservable = Rx.Observable.never();\r\n\r\nexport default function StateProxy(\r\n  {\r\n    root = false,\r\n    validate = () => true,\r\n  }: { root: boolean, validate: (value: any, props: Object) => boolean } = {},\r\n  uncontrolledConfig: { getValue: () => any, setValue: () => any } = {\r\n    getValue: () => undefined,\r\n    setValue: () => undefined,\r\n  },\r\n) {\r\n  return function(WrappedComponent: React$Component<any, any, any>) {\r\n    class ProxiedState extends React.Component {\r\n      parentValueChangeObs: Rx.Subject;\r\n      valueChangeObs: Rx.Subject;\r\n      subscription: Rx.Subscription;\r\n\r\n      constructor(props, context) {\r\n        super(props);\r\n\r\n        this.state = {\r\n          value: null,\r\n          validation: null,\r\n        };\r\n        this.configureObs(props, context);\r\n      }\r\n\r\n      getHumanReadableIdentifier(props, context) {\r\n        const currentStatePath = this.getCurrentStatePath(props, context, {});\r\n        return `ProxiedField with statePath ${currentStatePath != null &&\r\n        currentStatePath !== \"\"\r\n          ? currentStatePath\r\n          : '\"\"'} and name ${props.name != \"\" && props.name != undefined\r\n          ? props.name\r\n          : '\"\"'}`;\r\n      }\r\n\r\n      getAssignedObs(props, context) {\r\n        if (props.valueChangeObs) {\r\n          return props.valueChangeObs;\r\n        } else if (context.valueChangeObs) {\r\n          return context.valueChangeObs;\r\n        } else {\r\n          return NeverObservable;\r\n        }\r\n      }\r\n\r\n      configureObs(props, context) {\r\n        this.parentValueChangeObs = this.getAssignedObs(props, context);\r\n        if (this.parentValueChangeObs === NeverObservable && props.__debug)\r\n          console.warn(\r\n            `${this.getHumanReadableIdentifier(\r\n              props,\r\n              context,\r\n            )} hasn't received any valueChangeObs neither as props nor context. Maybe you have forgotten the FormController / StateDispatcher duo`,\r\n          );\r\n        this.valueChangeObs = this.parentValueChangeObs\r\n          .do(e => {\r\n            if (props.__debug) {\r\n              const path = this.getCompleteCurrentStatePath(\r\n                props,\r\n                context,\r\n                e.value,\r\n              );\r\n              if (path != \"\" && e.type === VALUE_CHANGE_EVENT_TYPE) {\r\n                console.log(\r\n                  \"FILTERING\",\r\n                  path,\r\n                  \"FOR STATEPATH\",\r\n                  e.statePath,\r\n                  \"PROPS\",\r\n                  props,\r\n                  \"CONTEXT\",\r\n                  context,\r\n                );\r\n              }\r\n            }\r\n          })\r\n          .filter(e => {\r\n            const path = this.getCompleteCurrentStatePath(\r\n              props,\r\n              context,\r\n              e.value,\r\n            );\r\n            return (\r\n              e.type === INITIAL_CHANGE_EVENT_TYPE ||\r\n              e.type === VALIDATION_FAILED_EVENT_TYPE ||\r\n              path.startsWith(e.statePath) ||\r\n              (root && e.statePath.startsWith(path))\r\n            );\r\n          })\r\n          .do(e => {\r\n            if (props.__debug) {\r\n              const path = this.getCompleteCurrentStatePath(\r\n                props,\r\n                context,\r\n                e.value,\r\n              );\r\n              if (path != \"\" && e.type === VALUE_CHANGE_EVENT_TYPE) {\r\n                console.log(\"REFRESHING\", path, \"FOR EVENT\", e);\r\n              }\r\n            }\r\n          })\r\n          .map(e =>\r\n            Object.assign({}, e, {\r\n              value: getValue(\r\n                e.value,\r\n                this.getCurrentStatePath(props, context, e.value),\r\n              ),\r\n              validation:\r\n                e.validation && e.validation instanceof Validation\r\n                  ? e.validation.getNestedValidation(\r\n                      this.getCurrentStatePath(props, context, e.value),\r\n                    )\r\n                  : e.validation,\r\n            }),\r\n          )\r\n          .do(e => {\r\n            if (props.__debug) {\r\n              console.log(\"FOUND VALUE:\", e);\r\n            }\r\n          });\r\n      }\r\n\r\n      connectToFormController(props, context) {\r\n        if (this.valueChangeObs && this.isControlled(props, context)) {\r\n          this.disconnectFromFormController();\r\n          this.subscription = this.valueChangeObs.subscribe(e => {\r\n            if (props.__debug) {\r\n              console.log(\r\n                \"Setting value\",\r\n                e,\r\n                `in ${root ? \"instance\" : \"state\"} mode`,\r\n              );\r\n            }\r\n            if (e.value === undefined) {\r\n              console.warn(\r\n                `${this.getHumanReadableIdentifier(\r\n                  props,\r\n                  context,\r\n                )} doesn't have any value set in the state, it may break`,\r\n              );\r\n            }\r\n            if (root) {\r\n              this.value = e.value;\r\n              this.validation = e.validation;\r\n            } else {\r\n              this.setState({\r\n                value: e.value,\r\n                validation: e.validation,\r\n              });\r\n            }\r\n          });\r\n        }\r\n      }\r\n\r\n      disconnectFromFormController() {\r\n        if (this.subscription) {\r\n          this.subscription.unsubscribe();\r\n        }\r\n      }\r\n\r\n      connectToUncontrolledHandlers(props, context) {\r\n        if (\r\n          props.name &&\r\n          context.addHandler &&\r\n          !this.isControlled(props, context)\r\n        ) {\r\n          if (\r\n            uncontrolledConfig.getValue == null ||\r\n            uncontrolledConfig.setValue == null\r\n          ) {\r\n            console.warn(\r\n              `${this.getHumanReadableIdentifier(\r\n                props,\r\n                context,\r\n              )} is uncontrolled but has no getValue / setValue defined, thus it is disabled and not connected`,\r\n            );\r\n          } else {\r\n            context.addHandler(\r\n              this.getCurrentStatePath(props, context),\r\n              () =>\r\n                root\r\n                  ? this.getUncontrolledState()\r\n                  : uncontrolledConfig.getValue(this.child),\r\n              value =>\r\n                root\r\n                  ? this.child.dispatchUncontrolledValues({ value: value })\r\n                  : uncontrolledConfig.setValue(this.child, value),\r\n            );\r\n          }\r\n        }\r\n      }\r\n\r\n      componentDidMount() {\r\n        this.connectToUncontrolledHandlers(this.props, this.context);\r\n        this.connectToFormController(this.props, this.context);\r\n      }\r\n\r\n      componentWillReceiveProps(nextProps, nextContext) {\r\n        if (\r\n          this.parentValueChangeObs !==\r\n          this.getAssignedObs(nextProps, nextContext)\r\n        ) {\r\n          console.log(\r\n            `Reconnecting ${this.getHumanReadableIdentifier(\r\n              nextProps,\r\n              nextContext,\r\n            )}`,\r\n          );\r\n          this.configureObs(nextProps, nextContext);\r\n          this.connectToFormController(nextProps, nextContext);\r\n        }\r\n      }\r\n\r\n      componentWillUnmount() {\r\n        this.disconnectFromFormController();\r\n      }\r\n\r\n      getNewPathPart(props, context, v) {\r\n        let value = getValue(v, context.statePath || \"\");\r\n        if (typeof value == \"object\" && Array.isArray(value)) {\r\n          let index = value.findIndex(v => v.id == props.name);\r\n          return (index != -1 ? index : \"\") + \".value\";\r\n        } else {\r\n          return props.name;\r\n        }\r\n      }\r\n\r\n      getNewCompletePathPart(props, context, v) {\r\n        let value = getValue(v, context.completeStatePath || \"\");\r\n        if (typeof value == \"object\" && Array.isArray(value)) {\r\n          let index = value.findIndex(v => v.id == props.name);\r\n          return (index != -1 ? index : \"\") + \".value\";\r\n        } else {\r\n          return props.name;\r\n        }\r\n      }\r\n\r\n      getCurrentStatePath(props, context, value) {\r\n        if (context.statePath && context.statePath != \"\" && props.name)\r\n          return (\r\n            context.statePath + \".\" + this.getNewPathPart(props, context, value)\r\n          );\r\n        else if (props.name) return this.getNewPathPart(props, context, value);\r\n        else if (context.statePath) return context.statePath;\r\n        else return \"\";\r\n      }\r\n\r\n      getCompleteCurrentStatePath(props, context, value) {\r\n        if (\r\n          props.valueChangeObs == null &&\r\n          context.completeStatePath &&\r\n          context.completeStatePath != \"\" &&\r\n          props.name\r\n        )\r\n          return (\r\n            context.completeStatePath +\r\n            \".\" +\r\n            this.getNewCompletePathPart(props, context, value)\r\n          );\r\n        else if (props.name)\r\n          return this.getNewCompletePathPart(props, context, value);\r\n        else if (props.valueChangeObs == null && context.completeStatePath)\r\n          return context.completeStatePath;\r\n        else return \"\";\r\n      }\r\n\r\n      isControlled(props, context) {\r\n        return props.uncontrolled || context.uncontrolled ? false : true;\r\n      }\r\n\r\n      getStatePathToDispatch(props, context) {\r\n        if (root) return \"\";\r\n        else return this.getCurrentStatePath(props, context);\r\n      }\r\n\r\n      getChildContext() {\r\n        return {\r\n          statePath: this.getStatePathToDispatch(this.props, this.context),\r\n          completeStatePath: this.getCompleteCurrentStatePath(\r\n            this.props,\r\n            this.context,\r\n          ),\r\n          uncontrolled: this.isControlled(this.props, this.context) === false,\r\n        };\r\n      }\r\n\r\n      getUncontrolledState() {\r\n        return this.child.getUncontrolledState();\r\n      }\r\n\r\n      render() {\r\n        const value =\r\n          this.state.value == undefined && this.props.value !== undefined\r\n            ? this.props.value\r\n            : this.state.value;\r\n        const validation =\r\n          this.state.validation == undefined &&\r\n          this.props.validation !== undefined\r\n            ? this.props.validation\r\n            : this.state.validation;\r\n        const statePath = this.getCurrentStatePath(this.props, this.context);\r\n        if (this.isControlled(this.props, this.context)) {\r\n          return (\r\n            <WrappedComponent\r\n              {...Object.assign({}, this.props, {\r\n                value: value,\r\n                validation: validation,\r\n                valueChangeObs: this.valueChangeObs,\r\n                rootValueChangeObs: this.context.rootValueChangeObs\r\n                  ? this.context.rootValueChangeObs\r\n                  : this.valueChangeObs,\r\n                onChange:\r\n                  this.props.onChange != null\r\n                    ? (newValue, sp) => {\r\n                        this.props.onChange(\r\n                          newValue,\r\n                          sp !== undefined ? sp : statePath,\r\n                          validate(newValue, this.props),\r\n                        );\r\n                      }\r\n                    : (newValue, sp) => {\r\n                        this.context.onStateChange(\r\n                          newValue,\r\n                          sp !== undefined ? sp : statePath,\r\n                          validate(newValue, this.props),\r\n                        );\r\n                      },\r\n                statePath: statePath,\r\n                getValue: root ? () => this.value : undefined,\r\n              })}\r\n              ref={elem => (this.child = elem)}\r\n            />\r\n          );\r\n        } else {\r\n          return (\r\n            <WrappedComponent\r\n              {...Object.assign({}, this.props, {\r\n                statePath: statePath,\r\n                getValue: root ? () => this.value : undefined,\r\n              })}\r\n              ref={elem => (this.child = elem)}\r\n            />\r\n          );\r\n        }\r\n      }\r\n    }\r\n\r\n    ProxiedState.defaultProps = Object.assign(\r\n      {\r\n        uncontrolled: false,\r\n      },\r\n      {\r\n        name:\r\n          (WrappedComponent.defaultProps &&\r\n            WrappedComponent.defaultProps.name) ||\r\n          undefined,\r\n      },\r\n    );\r\n\r\n    ProxiedState.contextTypes = {\r\n      statePath: React.PropTypes.string,\r\n      completeStatePath: React.PropTypes.string,\r\n      valueChangeObs: React.PropTypes.any,\r\n      onStateChange: React.PropTypes.func,\r\n      addHandler: React.PropTypes.func,\r\n      uncontrolled: React.PropTypes.bool,\r\n      rootValueChangeObs: React.PropTypes.any,\r\n    };\r\n\r\n    ProxiedState.childContextTypes = {\r\n      statePath: React.PropTypes.string,\r\n      completeStatePath: React.PropTypes.string,\r\n      uncontrolled: React.PropTypes.bool,\r\n    };\r\n\r\n    return ProxiedState;\r\n  };\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./lib/StateProxy.js","var g;\r\n\r\n// This works in non-strict mode\r\ng = (function() {\r\n\treturn this;\r\n})();\r\n\r\ntry {\r\n\t// This works if eval is allowed (see CSP)\r\n\tg = g || Function(\"return this\")() || (1,eval)(\"this\");\r\n} catch(e) {\r\n\t// This works if the window reference is available\r\n\tif(typeof window === \"object\")\r\n\t\tg = window;\r\n}\r\n\r\n// g can still be undefined, but nothing to do about it...\r\n// We return undefined, instead of nothing here, so it's\r\n// easier to handle this case. if(!global) { ...}\r\n\r\nmodule.exports = g;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// (webpack)/buildin/global.js\n// module id = 7\n// module chunks = 0","\"use babel\";\r\n// @flow\r\n\r\nexport function getImmutPath(path: string): Array<string | number> {\r\n  if (path == \"\") return [];\r\n  return path.split(\".\").map(p => isNaN(p) ? p : parseInt(p));\r\n}\r\n\r\nexport function getNewPath(\r\n  immutState: Object,\r\n  statePath: string,\r\n  name: string,\r\n): string {\r\n  if (isArray(getValue(immutState, statePath))) {\r\n    let index = getValue(immutState, statePath).findIndex(\r\n      obj => obj.id == name,\r\n    );\r\n    return `${statePath}${statePath.length > 0 ? \".\" : \"\"}${index}.value`;\r\n  } else {\r\n    return `${statePath}${statePath.length > 0 ? \".\" : \"\"}${name}`;\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./lib/StatePathHelpers.js","\"use babel\";\r\n// @flow\r\n\r\nimport React from \"react\";\r\nimport { fromJS, is } from \"immutable\";\r\nimport Rx from \"rxjs\";\r\nimport {\r\n  INITIAL_CHANGE_EVENT_TYPE,\r\n  VALIDATION_FAILED_EVENT_TYPE,\r\n  VALUE_CHANGE_EVENT_TYPE,\r\n  SUBMIT_EVENT_TYPE,\r\n  createInitialChangeEvent,\r\n  createSubmitChangeEvent,\r\n  createValidationFailedEvent,\r\n  createValueChangeEvent,\r\n} from \"./FormEvents\";\r\nimport { setValue } from \"./StateValueHelpers\";\r\nimport {\r\n  Validation,\r\n  type ValidationError,\r\n  type ValidationInfo,\r\n} from \"./ValidationHelpers\";\r\n\r\nexport default function FormController(\r\n  applyControl: (state: any) => any = state => state,\r\n  convertIn: (value: any, props: any) => Object = (value, props) => value,\r\n  convertOut: (value: any, props: any) => Object = (value, props) => value,\r\n  {\r\n    checkIfModified = true,\r\n    immutableInitial = false,\r\n  }: {\r\n    checkIfModified: boolean,\r\n    immutableInitial: boolean,\r\n  } = {},\r\n  validate: (value: any, props: any) => ValidationInfo = (value, props) => true,\r\n): (Comp: React$Component<any, any, any>) => React$Component<any, any, any> {\r\n  return function(\r\n    WrappedComponent: React$Component<any, any, any>,\r\n  ): React.Component<any, any, any> {\r\n    class Controller extends React.Component<any, any, any> {\r\n      subject: Rx.Subject;\r\n      valueChangeObs: Rx.Subject;\r\n      rootDispatcherGetter: ?() => any;\r\n\r\n      constructor(props) {\r\n        super();\r\n        this.subject = new Rx.Subject()\r\n          .scan(\r\n            (acc, e) => {\r\n              const newValidation =\r\n                e.validation != null ? e.validation : acc.validation;\r\n              switch (e.type) {\r\n                case VALUE_CHANGE_EVENT_TYPE:\r\n                  const newState = setValue(acc.value, e.statePath, e.newValue);\r\n                  const controlledNewState = applyControl(newState, this.props);\r\n                  return {\r\n                    type: VALUE_CHANGE_EVENT_TYPE,\r\n                    value: controlledNewState,\r\n                    oldValue: acc.value,\r\n                    statePath: e.statePath,\r\n                    validation: newValidation,\r\n                  };\r\n                case SUBMIT_EVENT_TYPE:\r\n                  return {\r\n                    type: SUBMIT_EVENT_TYPE,\r\n                    value: acc.value,\r\n                    validation: acc.validation,\r\n                  };\r\n                case INITIAL_CHANGE_EVENT_TYPE:\r\n                  return {\r\n                    type: INITIAL_CHANGE_EVENT_TYPE,\r\n                    value: e.newValue,\r\n                    oldValue: acc.value,\r\n                    validation: newValidation,\r\n                  };\r\n                case VALIDATION_FAILED_EVENT_TYPE:\r\n                  return {\r\n                    type: VALIDATION_FAILED_EVENT_TYPE,\r\n                    value: acc.value,\r\n                    validation: e.validation,\r\n                  };\r\n                default:\r\n                  return acc;\r\n              }\r\n            },\r\n            { value: this._getInitialValue(props), validation: true },\r\n          )\r\n          .do(\r\n            e =>\r\n              global.process &&\r\n              global.process.env &&\r\n              global.process.env.FORMALIZR_ENV === \"DEBUG\" &&\r\n              console.log(\"FormController event:\\n\", e),\r\n          )\r\n          .share();\r\n        this.subject.filter(e => e.type == SUBMIT_EVENT_TYPE).subscribe({\r\n          next: e => this._submit(e.value),\r\n        });\r\n        this.valueChangeObs = this.subject\r\n          .filter(\r\n            e =>\r\n              e.type == VALUE_CHANGE_EVENT_TYPE ||\r\n              e.type == INITIAL_CHANGE_EVENT_TYPE ||\r\n              e.type == VALIDATION_FAILED_EVENT_TYPE,\r\n          )\r\n          .publishBehavior({\r\n            type: INITIAL_CHANGE_EVENT_TYPE,\r\n            value: this._getInitialValue(props),\r\n            validation: true,\r\n          })\r\n          .refCount();\r\n        this.rootDispatcherGetter = null;\r\n      }\r\n\r\n      componentWillReceiveProps(nextProps) {\r\n        let newInitial = this._getInitialValue(nextProps);\r\n        let oldInitial = this._getInitialValue(this.props);\r\n        if (\r\n          (oldInitial != null &&\r\n            \"toJS\" in oldInitial &&\r\n            newInitial != null &&\r\n            \"toJS\" in newInitial) ||\r\n          immutableInitial\r\n        ) {\r\n          if (newInitial !== oldInitial)\r\n            this.subject.next(createInitialChangeEvent(newInitial));\r\n        } else if (oldInitial == null && newInitial != null) {\r\n          this.subject.next(createInitialChangeEvent(newInitial));\r\n        } else if (oldInitial != null && newInitial != null) {\r\n          if (!is(fromJS(newInitial), fromJS(oldInitial)))\r\n            this.subject.next(createInitialChangeEvent(newInitial));\r\n        }\r\n      }\r\n\r\n      componentWillUnmount() {\r\n        this.subject.unsubscribe();\r\n      }\r\n\r\n      _getInitialValue(props) {\r\n        let v =\r\n          typeof props.initial != \"function\"\r\n            ? props.initial\r\n            : props.initial(props);\r\n        return convertIn(v == null ? {} : v, props);\r\n      }\r\n\r\n      _mergeValues(value) {\r\n        return fromJS(value).mergeDeep(\r\n          this.rootDispatcherGetter\r\n            ? fromJS(this.rootDispatcherGetter())\r\n            : fromJS({}),\r\n        );\r\n      }\r\n\r\n      _submit(value) {\r\n        let newValue = this._mergeValues(value);\r\n        if (\r\n          checkIfModified === false ||\r\n          !is(newValue, fromJS(this._getInitialValue(this.props)))\r\n        ) {\r\n          const validation = validate(newValue.toJS(), this.props);\r\n          if (validation === true || validation == null) {\r\n            this.props.onSubmit(convertOut(newValue.toJS(), this.props));\r\n          } else {\r\n            const newValidation = new Validation(validation);\r\n            if (typeof this.props.onValidationFailed === \"function\") {\r\n              this.props.onValidationFailed(newValidation);\r\n            }\r\n            this.subject.next(createValidationFailedEvent(newValidation));\r\n          }\r\n        }\r\n      }\r\n\r\n      getChildContext() {\r\n        return {\r\n          attachToController: getter => {\r\n            this.rootDispatcherGetter = getter;\r\n          },\r\n        };\r\n      }\r\n      render() {\r\n        return (\r\n          <WrappedComponent\r\n            {...this.props}\r\n            onChange={(value: any, statePath: string, validation: Validation) =>\r\n              this.subject.next(\r\n                createValueChangeEvent(value, statePath, validation),\r\n              )}\r\n            valueChangeObs={this.valueChangeObs}\r\n            onSubmit={() => this.subject.next(createSubmitChangeEvent())}\r\n          />\r\n        );\r\n      }\r\n    }\r\n\r\n    Controller.childContextTypes = {\r\n      attachToController: React.PropTypes.func,\r\n    };\r\n\r\n    return Controller;\r\n  };\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./lib/FormController.js","// @flow\r\n\r\nimport { fromJS, List, Map } from \"immutable\";\r\n\r\nexport type ConversionModel = {\r\n  out?: string,\r\n  out_path?: string,\r\n  default?: ?any,\r\n  convertIn?: (value: any) => any,\r\n  convertOut?: (value: any) => any,\r\n  complex?: boolean,\r\n  validate?: $FlowFixMe,\r\n  [key: string]: ConversionModel,\r\n};\r\n\r\nexport type ConversionJob = {\r\n  in: string,\r\n  out: string,\r\n  convertIn: (v: any) => any,\r\n  convertOut: (v: any) => any,\r\n  validate: $FlowFixMe,\r\n  default: any,\r\n};\r\n\r\nexport type ConversionJobs = List<ConversionJob>;\r\n\r\nexport function convertConversionModelToConversionJobs(\r\n  model: ConversionModel,\r\n  currentInPath?: string = \"\",\r\n  parentOutPath?: string = \"\",\r\n): ConversionJobs {\r\n  if (typeof model !== \"object\" || model == null) {\r\n    return List();\r\n  }\r\n  const currentNodeOutPath =\r\n    \"out\" in model || \"out_path\" in model ? model.out || model.out_path : \"\";\r\n  const currentOutPath = `${parentOutPath != \"\"\r\n    ? `${parentOutPath}.${currentNodeOutPath}`\r\n    : currentNodeOutPath}`;\r\n  const jobs = List()\r\n    .concat(\r\n      currentInPath !== \"\"\r\n        ? List.of({\r\n            in: currentInPath,\r\n            out: currentOutPath,\r\n            convertIn: \"convertIn\" in model ? model.convertIn : undefined,\r\n            convertOut: \"convertOut\" in model ? model.convertOut : undefined,\r\n            default: model.default,\r\n            validate: \"validate\" in model ? model.validate : undefined,\r\n          })\r\n        : List(),\r\n    )\r\n    .concat(\r\n      Object.keys(model)\r\n        .filter(\r\n          nodeKey =>\r\n            ![\r\n              \"convertIn\",\r\n              \"convertOut\",\r\n              \"out\",\r\n              \"out_path\",\r\n              \"complex\",\r\n              \"default\",\r\n              \"validate\",\r\n            ].includes(nodeKey),\r\n        )\r\n        .reduce((red: ConversionJobs, nodeKey: string): ConversionJobs => {\r\n          const childNode = model[nodeKey];\r\n          const childInPath = currentInPath\r\n            ? `${currentInPath}.${nodeKey}`\r\n            : nodeKey;\r\n          return red.concat(\r\n            convertConversionModelToConversionJobs(\r\n              childNode,\r\n              childInPath,\r\n              currentOutPath,\r\n            ),\r\n          );\r\n        }, List()),\r\n    );\r\n  return jobs;\r\n}\r\n\r\nexport function convertIn(\r\n  value?: ?Object,\r\n  jobs: ConversionJobs,\r\n  props: Object,\r\n): Object {\r\n  if (value == null) return {};\r\n  const immutableValue = fromJS(value);\r\n  if (props && props.__debug && console.groupCollapsed) {\r\n    console.groupCollapsed(\"Form ConvertIn\");\r\n  }\r\n  const convertedValue = jobs\r\n    .reduceRight((red, job) => {\r\n      const inPath = job.in.split(\".\");\r\n      const outPath = job.out.split(\".\");\r\n      const notConvertedValue =\r\n        inPath.length === 1 && inPath[0] === \"\"\r\n          ? immutableValue\r\n          : immutableValue.getIn(inPath, red.getIn(outPath, job.default));\r\n      const inValue =\r\n        typeof job.convertIn === \"function\"\r\n          ? job.convertIn(notConvertedValue, props)\r\n          : notConvertedValue;\r\n      let newRed;\r\n      if (\r\n        (red.getIn(outPath) != null && inValue != null && inValue !== false) ||\r\n        (outPath.length === 1 && outPath[0] === \"\")\r\n      )\r\n        newRed = red;\r\n      else {\r\n        newRed = red.setIn(outPath, fromJS(inValue));\r\n      }\r\n      if (props && props.__debug) {\r\n        console.log(\r\n          \"ConvertIn reducing...\",\r\n          \"\\nState (initial, red):\",\r\n          immutableValue,\r\n          red,\r\n          \"\\nJob:\",\r\n          job,\r\n          \"\\nIn:\",\r\n          inPath,\r\n          inValue,\r\n          \"converted from\",\r\n          notConvertedValue,\r\n          \"\\nOut:\",\r\n          outPath,\r\n          \"\\nNew reduction:\",\r\n          newRed,\r\n        );\r\n      }\r\n      return newRed;\r\n    }, Map())\r\n    .toJS();\r\n  if (props && props.__debug) {\r\n    console.log(\r\n      \"ConvertIn converted\",\r\n      value,\r\n      \"into\",\r\n      convertedValue,\r\n      \"with props\",\r\n      props,\r\n      \"and jobs\",\r\n      jobs,\r\n    );\r\n    if (console.groupEnd) {\r\n      console.groupEnd();\r\n    }\r\n  }\r\n  return convertedValue;\r\n}\r\n\r\nexport function convertOut(\r\n  value?: ?Object,\r\n  jobs: ConversionJobs,\r\n  props: Object,\r\n): Object {\r\n  if (value == null) return {};\r\n  const immutableValue = fromJS(value);\r\n  if (props && props.__debug && console.groupCollapsed) {\r\n    console.groupCollapsed(\"Form ConvertOut\");\r\n  }\r\n  const convertedValue = jobs\r\n    .reduceRight((red, job) => {\r\n      const outPath = job.out.split(\".\");\r\n      const notConvertedValue = immutableValue.getIn(outPath);\r\n      const outValue =\r\n        typeof job.convertOut === \"function\"\r\n          ? job.convertOut(notConvertedValue, props)\r\n          : notConvertedValue;\r\n      if (outValue === undefined) {\r\n        return red;\r\n      }\r\n      const inPath = job.in.split(\".\");\r\n      let newRed;\r\n      if (\r\n        ((red.getIn(inPath) != null && outValue != null) ||\r\n          (inPath.length === 1 && inPath[0] === \"\")) &&\r\n        !job.convertOut\r\n      )\r\n        newRed = red;\r\n      else {\r\n        newRed = red.setIn(inPath, outValue);\r\n      }\r\n      if (props && props.__debug) {\r\n        console.log(\r\n          \"ConvertOut reducing...\",\r\n          \"\\nState (initial, red):\",\r\n          immutableValue,\r\n          red,\r\n          \"\\nJob:\",\r\n          job,\r\n          \"\\nOut:\",\r\n          outPath,\r\n          outValue,\r\n          \"converted from\",\r\n          notConvertedValue,\r\n          \"\\nIn:\",\r\n          inPath,\r\n          \"\\nNew reduction:\",\r\n          newRed,\r\n        );\r\n      }\r\n      return newRed;\r\n    }, Map())\r\n    .toJS();\r\n  if (props && props.__debug) {\r\n    console.log(\r\n      \"ConvertOut converted\",\r\n      value,\r\n      \"into\",\r\n      convertedValue,\r\n      \"with props\",\r\n      props,\r\n      \"and jobs\",\r\n      jobs,\r\n    );\r\n    if (console.groupEnd) {\r\n      console.groupEnd();\r\n    }\r\n  }\r\n  return convertedValue;\r\n}\r\n\r\nexport function validateModel(jobs: ConversionJobs) {\r\n  return function validateState(value?: ?Object, props: Object) {\r\n    const immutableValue = fromJS(value);\r\n    const wholeValidation = jobs.reduceRight((red, job) => {\r\n      const outPath = job.out.split(\".\");\r\n      const fieldValue = immutableValue.getIn(outPath);\r\n      if (\r\n        outPath.length === 1 &&\r\n        outPath[0] === \"\" &&\r\n        typeof job.validate === \"function\"\r\n      )\r\n        throw new Error(\r\n          \"You can't use validation if you don't have any out, either in the current node or a parent one. At \" +\r\n            job.in,\r\n        );\r\n      const validation =\r\n        typeof job.validate === \"function\"\r\n          ? job.validate(fieldValue, props)\r\n          : true;\r\n      if (\r\n        validation === true ||\r\n        validation === null ||\r\n        validation === undefined\r\n      ) {\r\n        return red;\r\n      } else {\r\n        return (typeof red === \"object\" ? red : Map()).setIn(\r\n          outPath,\r\n          validation,\r\n        );\r\n      }\r\n    }, true);\r\n\r\n    if (typeof wholeValidation === \"object\") return wholeValidation.toJS();\r\n    else return wholeValidation;\r\n  };\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./lib/FormModel.js","\"use babel\";\r\n// @flow\r\n\r\nimport React from \"react\";\r\nimport { fromJS, is, List } from \"immutable\";\r\nimport StateProxy from \"./StateProxy\";\r\nimport { setValue, getValue } from \"./StateValueHelpers\";\r\nimport Rx from \"rxjs\";\r\nimport { INITIAL_CHANGE_EVENT_TYPE } from \"./FormEvents\";\r\n\r\nexport default function StateDispatcher(\r\n  convertIn: (v: any, props: Props) => any = (v, props) => v,\r\n  convertOut: (v: any, props: Props) => any = (v, props) => v,\r\n) {\r\n  return function(WrappedComponent: React$Component<any, any, any>) {\r\n    class Dispatcher extends React.Component {\r\n      subscription: Rx.Subscription;\r\n      handlers: {\r\n        [key: string]: {\r\n          get: () => any,\r\n          set: (value: any) => void,\r\n        },\r\n      };\r\n      valueChangeObs: Rx.Observable;\r\n\r\n      constructor(props) {\r\n        super(props);\r\n\r\n        this.handlers = {};\r\n        this.valueChangeObs = props.valueChangeObs.map(e => {\r\n          const convertedValue = convertIn(e.value, props);\r\n          if (convertedValue === e.value) return e;\r\n          else\r\n            return Object.assign({}, e, {\r\n              value: convertedValue,\r\n              validation: e.validation,\r\n              statePath: e.type === INITIAL_CHANGE_EVENT_TYPE\r\n                ? undefined\r\n                : props.statePath,\r\n            });\r\n        });\r\n      }\r\n\r\n      componentDidMount() {\r\n        if (this.context.attachToController != null)\r\n          this.context.attachToController(() => this.getUncontrolledState());\r\n        this.subscription = this.valueChangeObs\r\n          .filter(e => e.type == INITIAL_CHANGE_EVENT_TYPE)\r\n          .do(e => {\r\n            if (\r\n              global.process &&\r\n              global.process.env &&\r\n              global.process.env.FORMALIZR_ENV === \"DEBUG\"\r\n            ) {\r\n              console.log(\r\n                `Dispatching uncontrolled values from ${this.props.statePath}`,\r\n              );\r\n            }\r\n          })\r\n          .subscribe({\r\n            next: e => this.dispatchUncontrolledValues(e),\r\n          });\r\n      }\r\n\r\n      componentWillUnmount() {\r\n        if (this.context.attachToController != null)\r\n          this.context.attachToController(null);\r\n        this.subscription.unsubscribe();\r\n      }\r\n\r\n      dispatchUncontrolledValues(event) {\r\n        Object.keys(this.handlers).forEach(statePath => {\r\n          if (\r\n            event.oldValue === undefined ||\r\n            getValue(convertIn(event.value, this.props), statePath) !==\r\n              getValue(convertIn(event.oldValue, this.props), statePath)\r\n          )\r\n            this.handlers[statePath].set(\r\n              getValue(convertIn(event.value, this.props), statePath),\r\n            );\r\n        });\r\n      }\r\n\r\n      getChildContext() {\r\n        return {\r\n          valueChangeObs: this.valueChangeObs,\r\n          rootValueChangeObs: this.props.rootValueChangeObs,\r\n          onStateChange: (v, statePath, validation) => {\r\n            const convertedInParentValue = convertIn(\r\n              this.props.getValue(),\r\n              this.props,\r\n            );\r\n            const completeValue = Array.isArray(convertedInParentValue) ===\r\n              false\r\n              ? Object.assign({}, convertedInParentValue, { [statePath]: v })\r\n              : List().concat(convertedInParentValue).update(list => {\r\n                  return list.update(\r\n                    list.findIndex(item => item.id === statePath),\r\n                    item => Object.assign({}, item, { value: v }),\r\n                  );\r\n                });\r\n            const convertedValue = convertOut(completeValue, this.props);\r\n            // console.log(\r\n            //   \"On change\",\r\n            //   completeValue,\r\n            //   convertedValue,\r\n            //   completeValue !== convertedValue,\r\n            //   v,\r\n            //   statePath,\r\n            // );\r\n            if (\r\n              convertedValue !== completeValue ||\r\n              typeof convertedValue != typeof this.props.getValue()\r\n            )\r\n              this.props.onChange(\r\n                convertedValue,\r\n                this.props.statePath,\r\n                validation,\r\n              );\r\n            else\r\n              this.props.onChange(\r\n                v,\r\n                `${this.props.statePath}${this.props.statePath == \"\" || statePath == \"\" ? \"\" : \".\"}${statePath}`,\r\n                validation,\r\n              );\r\n          },\r\n          attachToController: null,\r\n          addHandler: ((statePath, getHandler, setHandler) => {\r\n            this.handlers = Object.assign({}, this.handlers, {\r\n              [statePath]: {\r\n                get: getHandler,\r\n                set: setHandler,\r\n              },\r\n            });\r\n          }).bind(this),\r\n        };\r\n      }\r\n\r\n      getUncontrolledState() {\r\n        let value = Object.keys(this.handlers).reduce(\r\n          (red, statePath) =>\r\n            setValue(red, statePath, this.handlers[statePath].get()),\r\n          {},\r\n        );\r\n        return convertOut(value, this.props);\r\n      }\r\n\r\n      render() {\r\n        return <WrappedComponent {...this.props} />;\r\n      }\r\n    }\r\n\r\n    Dispatcher.defaultProps = Object.assign({}, WrappedComponent.defaultProps, {\r\n      onChange() {},\r\n      value: {},\r\n      valueChangeObs: Rx.Observable.never(),\r\n    });\r\n\r\n    Dispatcher.propTypes = {\r\n      valueChangeObs: React.PropTypes.any,\r\n      onChange: React.PropTypes.func,\r\n    };\r\n\r\n    Dispatcher.childContextTypes = {\r\n      valueChangeObs: React.PropTypes.any,\r\n      onStateChange: React.PropTypes.func,\r\n      addHandler: React.PropTypes.func,\r\n      attachToController: React.PropTypes.func,\r\n      rootValueChangeObs: React.PropTypes.any,\r\n    };\r\n\r\n    Dispatcher.contextTypes = {\r\n      attachToController: React.PropTypes.func,\r\n    };\r\n\r\n    return StateProxy(\r\n      { root: true },\r\n      {\r\n        getValue: child => child.getUncontrolledState(),\r\n        setValue: child => {},\r\n      },\r\n    )(Dispatcher);\r\n  };\r\n}\r\n\r\ntype Props = {\r\n  valueChangeObs?: Rx.Observable,\r\n  onChange?: (v: any) => void,\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./lib/StateDispatcher.js","\"use babel\";\r\n// @flow\r\nimport React from \"react\";\r\nimport StateProxy from \"./StateProxy\";\r\nimport {\r\n  INITIAL_CHANGE_EVENT_TYPE,\r\n  VALIDATION_FAILED_EVENT_TYPE,\r\n} from \"./FormEvents\";\r\nimport Rx from \"rxjs\";\r\n\r\nconst NeverObservable = Rx.Observable.never();\r\n\r\nexport default class StateInjector extends React.Component<\r\n  DefaultProps,\r\n  Props,\r\n  State,\r\n> {\r\n  state: State;\r\n  props: Props;\r\n  watchPath: string;\r\n  valueChangeObs: Rx.Observable;\r\n  subscription: Rx.Subscription;\r\n  static defaultProps: DefaultProps;\r\n\r\n  constructor(props: Props, context: Context) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      value: null,\r\n      validation: true,\r\n    };\r\n\r\n    this.watchPath = this.getWatchedPath(props, context);\r\n    if (this.watchPath == null) {\r\n      throw new Error(\r\n        \"watchPath props is not set on StateInjector, you have to set a statepath string on which the StateInjector will watch\",\r\n      );\r\n    }\r\n    this.selectObs(props, context);\r\n  }\r\n\r\n  getAssignedObs(props: Props, context: Context): Rx.Observable<any> {\r\n    if (context.rootValueChangeObs != null) return context.rootValueChangeObs;\r\n    else return NeverObservable;\r\n  }\r\n\r\n  selectObs(props: Props, context: Context) {\r\n    this.valueChangeObs = this.getAssignedObs(props, context).filter(e => {\r\n      if (props.__debug) {\r\n        console.log(\"FILTERING\", e, \"In watcher\", this.watchPath);\r\n      }\r\n      if (e.statePath)\r\n        return (\r\n          this.watchPath.startsWith(e.statePath) ||\r\n          e.statePath.startsWith(this.watchPath)\r\n        );\r\n      else if (e.type === INITIAL_CHANGE_EVENT_TYPE) return true;\r\n      else if (e.type === VALIDATION_FAILED_EVENT_TYPE) return true;\r\n      else return false;\r\n    });\r\n  }\r\n\r\n  connectsToFormController() {\r\n    if (this.subscription) this.subscription.unsubscribe();\r\n    this.subscription = this.valueChangeObs.subscribe(e => {\r\n      this.setState({\r\n        value: e.value,\r\n        validation: e.validation,\r\n      });\r\n    });\r\n  }\r\n\r\n  getWatchedPath(props: Props, context: Context): string {\r\n    return typeof props.watchPath === \"function\"\r\n      ? props.watchPath(context.completeStatePath || \"\")\r\n      : props.watchPath;\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.connectsToFormController();\r\n  }\r\n\r\n  componentWillReceiveProps(nextProps: Props, nextContext: Context) {\r\n    if (this.valueChangeObs !== this.getAssignedObs(nextProps, nextContext)) {\r\n      this.selectObs(nextProps, nextContext);\r\n      this.connectsToFormController();\r\n    }\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    if (this.subscription) {\r\n      this.subscription.unsubscribe();\r\n      this.subscription = null;\r\n    }\r\n  }\r\n\r\n  render() {\r\n    if (typeof this.props.children !== \"function\")\r\n      throw new Error(\r\n        \"children of StateInjector must be a function of type (stateValue, props) => React$element\",\r\n      );\r\n    const watchedValidation = typeof this.state.validation === \"object\" &&\r\n      this.state.validation !== null\r\n      ? this.state.validation.getNestedValidation(this.watchPath)\r\n      : this.state.validation;\r\n    return this.props.children(this.state.value, this.props, {\r\n      watchedStatePath: this.watchPath,\r\n      watchedValidation,\r\n      validation: this.state.validation,\r\n    });\r\n  }\r\n}\r\n\r\nStateInjector.propTypes = {};\r\n\r\nStateInjector.defaultProps = {\r\n  __debug: false,\r\n};\r\n\r\nStateInjector.contextTypes = {\r\n  rootValueChangeObs: React.PropTypes.any,\r\n  completeStatePath: React.PropTypes.string,\r\n};\r\n\r\ntype DefaultProps = {\r\n  __debug: false,\r\n};\r\n\r\ntype Props = {\r\n  watchPath: string | ((path: string) => string),\r\n  __debug?: boolean,\r\n};\r\n\r\ntype State = {\r\n  value: any,\r\n  validation: any,\r\n};\r\n\r\ntype Context = {\r\n  completeStatePath?: string,\r\n  rootValueChangeObs: Rx.Observable,\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./lib/StateInjector.js","// @flow\r\n\r\nimport { fromJS } from \"immutable\";\r\n\r\nexport function notNull(\r\n  { errorString = \"Not filled\" }: { errorString?: string } = {},\r\n) {\r\n  return function validateNotNull(value: mixed) {\r\n    if (value === null) {\r\n      return errorString;\r\n    } else {\r\n      return true;\r\n    }\r\n  };\r\n}\r\n\r\nexport function notUndefined(\r\n  { errorString = \"not filled\" }: { errorString?: string } = {},\r\n) {\r\n  return function validateNotUndefined(value: mixed) {\r\n    if (value === undefined) {\r\n      return errorString;\r\n    } else {\r\n      return true;\r\n    }\r\n  };\r\n}\r\n\r\nexport function notEmpty(\r\n  { errorString = \"not filled\" }: { errorString?: string } = {},\r\n) {\r\n  return function validateNotEmpty(value: mixed) {\r\n    if (value === \"\") {\r\n      return errorString;\r\n    } else {\r\n      return true;\r\n    }\r\n  };\r\n}\r\n\r\nexport function composeValidation(...validates) {\r\n  return function validateValue(value: mixed, props: Object) {\r\n    return validates.reduce((red, validate) => {\r\n      if (red !== true) return red;\r\n      const validated = validate(value, props);\r\n      if (validated === true) return true;\r\n      else return validated;\r\n    }, true);\r\n  };\r\n}\r\n\r\nexport function required(\r\n  { errorString = \"not filled\" }: { errorString?: string } = {},\r\n) {\r\n  return composeValidation(\r\n    notUndefined({ errorString }),\r\n    notNull({ errorString }),\r\n    notEmpty({ errorString }),\r\n  );\r\n}\r\n\r\nexport function isTrue(\r\n  { errorString = \"not true\" }: { errorString?: string } = {},\r\n) {\r\n  return function validateTrue(value: mixed) {\r\n    if (value !== true) {\r\n      return errorString;\r\n    } else {\r\n      return true;\r\n    }\r\n  };\r\n}\r\n\r\nexport function maxLength(\r\n  max: number,\r\n  { errorString = \"too long\" }: { errorString?: string } = {},\r\n) {\r\n  return function validateMaxLength(value: mixed) {\r\n    if (typeof value !== \"string\" || value.length > max) {\r\n      return errorString;\r\n    } else {\r\n      return true;\r\n    }\r\n  };\r\n}\r\n\r\nexport function lessThan(\r\n  accessor1: (value: mixed, props: Object) => mixed | string,\r\n  accessor2: (value: mixed, props: Object) => mixed | string,\r\n  { error = \"Invalid\" }: { error?: mixed } = {},\r\n) {\r\n  return function validateLessThan(value: mixed, props: Object) {\r\n    if (\r\n      (typeof accessor1 !== \"function\" && typeof accessor1 !== \"string\") ||\r\n      (typeof accessor2 !== \"function\" && typeof accessor2 !== \"string\")\r\n    )\r\n      throw new Error(\r\n        \"lessThan validator takes either a function or a stringPath as accessor type\",\r\n      );\r\n    const value1 =\r\n      typeof accessor1 === \"function\"\r\n        ? accessor1(value, props)\r\n        : fromJS(value).getIn(accessor1.split(\".\"));\r\n    const value2 =\r\n      typeof accessor2 === \"function\"\r\n        ? accessor2(value, props)\r\n        : fromJS(value).getIn(accessor2.split(\".\"));\r\n    // $FlowFixMe\r\n    if (value1 > value2) {\r\n      if (typeof error === \"function\") return error(value, props);\r\n      else return error;\r\n    } else {\r\n      return true;\r\n    }\r\n  };\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./lib/ValidationComposition.js","\"use babel\";\r\n// @flow\r\n\r\nexport { default as FormController } from \"./FormController\";\r\nexport { default as StateDispatcher } from \"./StateDispatcher\";\r\nexport { default as StateProxy } from \"./StateProxy\";\r\nexport { default as StateInjector } from \"./StateInjector\";\r\nexport { getValue } from \"./StateValueHelpers\";\r\nexport {\r\n  notNull,\r\n  notUndefined,\r\n  notEmpty,\r\n  composeValidation,\r\n  required,\r\n  isTrue,\r\n  maxLength,\r\n  lessThan,\r\n} from \"./ValidationComposition\";\r\nexport {\r\n  convertConversionModelToConversionJobs,\r\n  convertIn,\r\n  convertOut,\r\n  validateModel,\r\n} from \"./FormModel\";\r\nexport { isValid, getErrorText } from \"./ValidationHelpers\";\r\n\n\n\n// WEBPACK FOOTER //\n// ./lib/index.js"],"sourceRoot":""}